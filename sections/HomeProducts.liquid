<div class="flex flex-col pr-70px max-lg:pr-0">
    {% assign all_products = collections.all.products %}
    {% for product in all_products %}
        {% assign video_url = product.media[0].sources[1].url %}
        <div class="homeproduct w-full  min-h-dvh flex justify-between max-lg:flex max-lg:flex-col">
            <div class="video min-w-50% w-10% max-lg:w-full max-md:w-full transition-all duration-1000 ease">
                {% if video_url != blank %}
                    <video autoplay loop muted class="w-full h-full object-cover border-solid border border-black max-lg:min-h-500px">
                        <source src="{{ video_url }}" type="video/mp4">
                    </video>
                {% endif %}
            </div>
            <div class="prouctcontent flex-grow max-lg:w-full transition-all duration-1000 ease border-solid border border-black overflow-hidden">
                <div class="flex overflow-hidden w-full h-full bg-white left-1/2 max-lg:flex-col">
                    <div class="p-8 min-w-[45vw-35] w-[45vw-35] text-3xl relative max-lg:w-full">
                        <h1 class="text-28px mb-20px">{{ product.title }}</h1>
                        <div class="text-customGray mb-30px text-28px">{{ product.description }}</div>
                        <button class="showdetailsButton w-11 h-11 rounded-full bg-slate-200">
                            <svg xmlns="http://www.w3.org/2000/svg" width="21" height="5" viewBox="0 0 21 5" fill="none" class="mx-auto">
                                <circle cx="2.5" cy="2.5" r="2.5" fill="#1E1E1E"></circle>
                                <circle cx="10.5" cy="2.5" r="2.5" fill="#1E1E1E"></circle>
                                <circle cx="18.5" cy="2.5" r="2.5" fill="#1E1E1E"></circle>
                            </svg>
                        </button>
                    </div>
                    <div class="product_details overflow-hidden flex-grow transition-all duration-1000 ease max-md:fixed max-md:bottom-m400px max-md:w-full max-md:h-360px">
                        {% assign json_array = '' %}
                        {% for pro in product.variants %}
                            {% assign item = '{' | append: '"id":' | append: pro.id | append: ', "available":' | append: pro.available | append: ', "price":' | append: pro.price | append: ', "size":"' | append: pro.option1 | append: '", "color":"' | append: pro.option2 | append: '"}' %}
                            {% if forloop.last %}
                                {% assign json_array = json_array | append: item %}
                            {% else %}
                                {% assign json_array = json_array | append: item | append: ',' %}
                            {% endif %}
                        {% endfor %}
                        {% assign json_array = '[' | append: json_array | append: ']' %}
                        <product-forms
                            title='{{ product.title }}'
                            content='{{ json_array | replace: '=>', ':' | replace: 'nil', 'null' }}'
                        >
                        </product-forms> 
                    </div>
                </div>
            </div>
        </div>
    {% endfor %}
</div>

<script>
    var buttons = document.querySelectorAll('.showdetailsButton');
    var contents = document.querySelectorAll('.productcontent');
    var videos = document.querySelectorAll('.video');
    var details = document.querySelectorAll('.product_details');
    var divtts = document.querySelectorAll('.homeproduct')
    
    buttons.forEach((button, index)=>{
        button.addEventListener('click', function(){
            if(window.innerWidth > 768){
                divtts[index].scrollIntoView({behavior:"smooth"})
                setTimeout(() => {
                    if(videos[index].classList.contains('min-w-50%')){
                        videos[index].classList.remove('min-w-50%');
                        videos[index].classList.add('min-w-10%');
                    }
                    else{
                        videos[index].classList.remove('min-w-10%');
                        videos[index].classList.add('min-w-50%');
                    }
                }, 500);
            }
            else{
                details[index].classList.remove('max-md:bottom-m400px')
                details[index].classList.add('max-md:bottom-0')
            }
        })
    })

    videos.forEach((item, index)=>{
        item.addEventListener('click', function(){
            item.classList.remove('min-w-10%');
            item.classList.add('min-w-50%');
        })
    })
</script>


{% schema %}
    {
        "name": "Home_product",
        "tag": "section",
        "class": "section",
        "settings": [
    
        ],
        "presets": [
            {
                "name": "Home_product"
            }
        ]
    }
    {% endschema %}